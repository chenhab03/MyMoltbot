<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æƒ…ä¾£é£è¡Œæ£‹ Â· æš§æ˜§å‡çº§ç‰ˆ ğŸ’</title>
  <style>
    body{font-family:system-ui,-apple-system;background:#0f172a;color:#e5e7eb;display:flex;justify-content:center;align-items:center;min-height:100vh}
    .app{background:#020617;border-radius:16px;padding:16px;width:360px;box-shadow:0 20px 40px rgba(0,0,0,.4)}
    h1{margin:0 0 8px 0;font-size:20px;text-align:center}
    .hint{font-size:12px;opacity:.9;text-align:center;margin-bottom:8px}
    .board{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;margin:12px 0}
    .cell{aspect-ratio:1;border:1px solid #1e293b;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:10px;position:relative}
    .cell.finish{background:#022c22;border-color:#14532d}
    .token{width:16px;height:16px;border-radius:50%;position:absolute}
    .a{background:#38bdf8}
    .b{background:#f472b6}
    .controls{display:flex;gap:8px}
    button{flex:1;padding:10px;border-radius:8px;border:none;background:#38bdf8;color:#020617;font-weight:bold;cursor:pointer}
    .status{margin-top:8px;font-size:13px;text-align:center}
    .card{margin-top:8px;padding:8px;border-radius:8px;background:#020617;border:1px solid #1e293b;font-size:12px}
  </style>
</head>
<body>
  <div class="app">
    <h1>âœˆï¸ æƒ…ä¾£é£è¡Œæ£‹ Â· æš§æ˜§å‡çº§</h1>
    <div class="hint">ä»…é™æˆå¹´äººã€‚æ›´æš§æ˜§çš„æš—ç¤ºä¸æ°›å›´ï¼Œä½†ä¸éœ²éª¨ ğŸ’—</div>
    <div id="board" class="board"></div>
    <div class="controls">
      <button id="roll">æ·éª°å­ ğŸ²</button>
      <button id="reset" style="background:#64748b">é‡æ¥</button>
    </div>
    <div id="status" class="status"></div>
    <div id="card" class="card">äº‹ä»¶å¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
  </div>

<script>
const SIZE = 30; // 6x5
// æ›´æš§æ˜§ï¼šåŠ é‡å¼ åŠ›ã€é è¿‘ã€ä½è¯­ã€èº«ä½“è·ç¦»ç­‰æš—ç¤ºï¼ˆä¸æå†™å…·ä½“æ€§è¡Œä¸ºï¼‰
const events = {
  2:  { text: 'ç›®å…‰çº ç¼ ï¼Œè·ç¦»è¢«æ‚„æ‚„æ‹‰è¿‘â€¦ ğŸ˜Œ å‰è¿› +1', move:+1 },
  4:  { text: 'è€³è¾¹ä½è¯­ï¼Œæ°”æ¯æ‹‚è¿‡ï¼Œå¿ƒè·³å¤±åº ğŸ’“ å‰è¿› +1', move:+1 },
  6:  { text: 'è½»è§¦åœç•™å¾—ä¹…äº†ä¸€ç‚¹ç‚¹â€¦ ğŸ”¥ å‰è¿› +2', move:+2 },
  9:  { text: 'æš§æ˜§ç¬‘æ„ï¼Œæ—¶é—´åƒè¢«æŒ‰ä¸‹æš‚åœé”® ğŸ’‹ è·³åˆ° 12', jump:12 },
  12: { text: 'æ‰‹æŒ‡äº¤æ‰£ï¼Œå‘¼å¸åŒæ­¥ï¼Œç»§ç»­å‡æ¸© ğŸ’ å†å‰è¿› +1', move:+1 },
  14: { text: 'å¤ªæ’©äººè¢«é€—ç¬‘ï¼Œç¨ä½œé€€è®© ğŸ˜ åé€€ 1', move:-1 },
  17: { text: 'é å¾—æ›´è¿‘ï¼Œä¸–ç•Œåªå‰©å½¼æ­¤çš„å­˜åœ¨ ğŸŒ™ å‰è¿› +2', move:+2 },
  20: { text: 'æš§æ˜§æ‹‰æ‰¯ï¼Œæ¬²è¿›è¿˜é€€ï¼Œé‡æ–°é…é…¿ ğŸ˜ˆ å›åˆ° 18', jump:18 },
  23: { text: 'çœ¼ç¥ç‚¹ç«ï¼Œæ°”æ°›é«˜æ¶¨ï¼Œé¡ºåŠ¿æ¨è¿› ğŸ”¥ å‰è¿› +3', move:+3 }
};

let state = JSON.parse(localStorage.getItem('couple-flight')) || { turn:'A', A:0, B:0, finished:false };

const board = document.getElementById('board');
const statusEl = document.getElementById('status');
const cardEl = document.getElementById('card');

function save(){ localStorage.setItem('couple-flight', JSON.stringify(state)); }

function buildBoard(){
  board.innerHTML='';
  for(let i=1;i<=SIZE;i++){
    const c=document.createElement('div');
    c.className='cell'+(i===SIZE?' finish':'');
    c.textContent=i;
    c.id='cell-'+i;
    board.appendChild(c);
  }
}

function placeTokens(){
  document.querySelectorAll('.token').forEach(t=>t.remove());
  if(state.A>0){ const t=document.createElement('div'); t.className='token a'; document.getElementById('cell-'+state.A)?.appendChild(t);} 
  if(state.B>0){ const t=document.createElement('div'); t.className='token b'; document.getElementById('cell-'+state.B)?.appendChild(t);} 
}

function applyEvent(player){
  const pos = state[player];
  const ev = events[pos];
  if(ev){
    cardEl.textContent = ev.text;
    if(typeof ev.move==='number') state[player]+=ev.move;
    if(typeof ev.jump==='number') state[player]=ev.jump;
  } else {
    cardEl.textContent = 'æš§æ˜§åœ¨ç©ºæ°”ä¸­è”“å»¶â€¦ ğŸ’« ç»§ç»­å‰è¿›';
  }
}

function update(){
  placeTokens();
  if(state.finished){ statusEl.textContent='æ¸¸æˆç»“æŸ'; return; }
  statusEl.textContent = `è½®åˆ° ${state.turn==='A'?'ä½ ':'TA'} æ·éª°å­`;
  save();
}

function roll(){
  if(state.finished) return;
  const dice = Math.ceil(Math.random()*6);
  const p = state.turn;
  state[p] += dice;
  if(state[p] >= SIZE){ state[p]=SIZE; state.finished=true; cardEl.textContent = `${p==='A'?'ä½ ':'TA'} æŠµè¾¾ç»ˆç‚¹ï¼Œå¤œè‰²æ­£å¥½â€¦ ğŸ‰`; update(); return; }
  applyEvent(p);
  state.turn = p==='A'?'B':'A';
  update();
}

function reset(){ state={turn:'A',A:0,B:0,finished:false}; save(); buildBoard(); update(); }

document.getElementById('roll').onclick=roll;
document.getElementById('reset').onclick=reset;

buildBoard(); update();
</script>
</body>
</html>